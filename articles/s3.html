<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>S3 • sixtyfour</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="S3">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sixtyfour</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/sixtyfour.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/auth.html">Managing AWS Auth</a></li>
    <li><a class="dropdown-item" href="../articles/billing.html">Explore Billing Data</a></li>
    <li><a class="dropdown-item" href="../articles/contributing.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../articles/databases.html">Databases</a></li>
    <li><a class="dropdown-item" href="../articles/s3.html">S3</a></li>
    <li><a class="dropdown-item" href="../articles/s3iam.html">Managing buckets in a small group of users</a></li>
    <li><a class="dropdown-item" href="../articles/six.html">High level six functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/getwilds/sixtyfour/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>S3</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/getwilds/sixtyfour/blob/main/vignettes/s3.Rmd" class="external-link"><code>vignettes/s3.Rmd</code></a></small>
      <div class="d-none name"><code>s3.Rmd</code></div>
    </div>

    
    
<p>This vignette focuses on blob storage using S3. See the Getting
Started vignette for basic setup if you have not done that yet.</p>
<p>S3 stands for Simple Storage Service - a product from AWS (Amazon Web
Services). It’s sort of like a file system on your computer in that you
can store any arbitrary file type: an image, a spreadsheet, a
presentation, a zip file, etc. - you can do the same in S3, but the
files are called “objects”. S3 is used for backups, archiving, data
storage for many kinds of web or native apps, and more - and many AWS
services work smoothly with S3 as the data storage layer. There’s many
S3 “compatible” clones offered by other companies, e.g., R2 from
Cloudflare and Spaces from DigitalOcean.</p>
<p>This vignette breaks down use cases around buckets (or groups of
objects), and files (aka objects). <code>sixtyfour</code> has many
functions for buckets and files with lower level methods prefixed with
<code>aws_</code> while higher level functions are prefixed with
<code>six_</code>.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/getwilds/sixtyfour" class="external-link">sixtyfour</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="buckets">Buckets<a class="anchor" aria-label="anchor" href="#buckets"></a>
</h2>
<p>Make a random bucket name with <code><a href="../reference/random_string.html">random_bucket()</a></code> from
<code>sixtyfour</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bucket</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/random_string.html">random_bucket</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bucket</span></span>
<span><span class="co">#&gt; bucket-pjwcmbnahdoyvurs</span></span></code></pre></div>
<p>Create a bucket - check if it exists first</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exists</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aws_bucket_exists.html">aws_bucket_exists</a></span><span class="op">(</span><span class="va">bucket</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">exists</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/aws_bucket_create.html">aws_bucket_create</a></span><span class="op">(</span><span class="va">bucket</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "http://bucket-pjwcmbnahdoyvurs.s3.amazonaws.com/"</span></span></code></pre></div>
<p>Create files in a few different directories</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fs.r-lib.org" class="external-link">fs</a></span><span class="op">)</span></span>
<span><span class="va">tdir</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"apples"</span><span class="op">)</span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html" class="external-link">dir_create</a></span><span class="op">(</span><span class="va">tdir</span><span class="op">)</span></span>
<span><span class="va">tfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_temp.html" class="external-link">file_temp</a></span><span class="op">(</span>tmp_dir <span class="op">=</span> <span class="va">tdir</span>, ext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tfiles</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Upload them to the newly created bucket</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/aws_bucket_upload.html">aws_bucket_upload</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">tdir</span>, bucket <span class="op">=</span> <span class="va">bucket</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s3://bucket-pjwcmbnahdoyvurs"</span></span></code></pre></div>
<p>List objects in the bucket</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">objects</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aws_bucket_list_objects.html">aws_bucket_list_objects</a></span><span class="op">(</span><span class="va">bucket</span><span class="op">)</span></span>
<span><span class="va">objects</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 8</span></span>
<span><span class="co">#&gt;    bucket         key   uri    size type  etag  lastmodified        storageclass</span></span>
<span><span class="co">#&gt;    &lt;glue&gt;         &lt;chr&gt; &lt;glu&gt; &lt;fs:&gt; &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;       </span></span>
<span><span class="co">#&gt;  1 bucket-pjwcmb… file… s3:/… 1.74K file  "\"6… 2025-03-12 22:50:16 STANDARD    </span></span>
<span><span class="co">#&gt;  2 bucket-pjwcmb… file… s3:/… 1.74K file  "\"6… 2025-03-12 22:50:16 STANDARD    </span></span>
<span><span class="co">#&gt;  3 bucket-pjwcmb… file… s3:/… 1.74K file  "\"6… 2025-03-12 22:50:16 STANDARD    </span></span>
<span><span class="co">#&gt;  4 bucket-pjwcmb… file… s3:/… 1.74K file  "\"6… 2025-03-12 22:50:16 STANDARD    </span></span>
<span><span class="co">#&gt;  5 bucket-pjwcmb… file… s3:/… 1.74K file  "\"6… 2025-03-12 22:50:17 STANDARD    </span></span>
<span><span class="co">#&gt;  6 bucket-pjwcmb… file… s3:/… 1.74K file  "\"6… 2025-03-12 22:50:17 STANDARD    </span></span>
<span><span class="co">#&gt;  7 bucket-pjwcmb… file… s3:/… 1.74K file  "\"6… 2025-03-12 22:50:17 STANDARD    </span></span>
<span><span class="co">#&gt;  8 bucket-pjwcmb… file… s3:/… 1.74K file  "\"6… 2025-03-12 22:50:17 STANDARD    </span></span>
<span><span class="co">#&gt;  9 bucket-pjwcmb… file… s3:/… 1.74K file  "\"6… 2025-03-12 22:50:17 STANDARD    </span></span>
<span><span class="co">#&gt; 10 bucket-pjwcmb… file… s3:/… 1.74K file  "\"6… 2025-03-12 22:50:17 STANDARD</span></span></code></pre></div>
<p>Cleanup - delete the bucket.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/aws_bucket_delete.html">aws_bucket_delete</a></span><span class="op">(</span><span class="va">bucket</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Error: BucketNotEmpty (HTTP 409). The bucket you tried to delete is not empty</span></span></code></pre>
<p>If there’s files in your bucket you can not delete the bucket. First,
delete all the files, then delete the bucket again:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/aws_file_delete.html">aws_file_delete</a></span><span class="op">(</span><span class="va">objects</span><span class="op">$</span><span class="va">uri</span><span class="op">)</span> <span class="co"># vector accepted</span></span>
<span><span class="fu"><a href="../reference/aws_bucket_list_objects.html">aws_bucket_list_objects</a></span><span class="op">(</span><span class="va">bucket</span><span class="op">)</span> <span class="co"># no objects remaining</span></span>
<span><span class="fu"><a href="../reference/aws_bucket_delete.html">aws_bucket_delete</a></span><span class="op">(</span><span class="va">bucket</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="files">Files<a class="anchor" aria-label="anchor" href="#files"></a>
</h2>
<p>All or most of the file functions are built around accepting and
returning character vectors of length one or greater. This includes the
functions that take two inputs, such as a source and destination file.
Rather than using the <code>paws</code> package under the hood as most
functions in this package use, the file functions use <code>s3fs</code>
under the hood (which is itself built on <code>paws</code>) as
<code>s3fs</code> is a cleaner interface to S3 than
<code>paws</code>.</p>
<p>First, create a bucket:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_bucket</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/random_string.html">random_bucket</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/aws_bucket_create.html">aws_bucket_create</a></span><span class="op">(</span><span class="va">my_bucket</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "http://bucket-sdcghqxilarjzpnk.s3.amazonaws.com/"</span></span></code></pre></div>
<p>Then, upload some files</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">temp_files</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">letters</span>, <span class="st">"\n"</span>, file <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span><span class="va">remote_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/s3fs/man/path.html" class="external-link">s3_path</a></span><span class="op">(</span><span class="va">my_bucket</span>, <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">temp_files</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/aws_file_upload.html">aws_file_upload</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">temp_files</span>, remote_path <span class="op">=</span> <span class="va">remote_files</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s3://bucket-sdcghqxilarjzpnk/file68b73610b168.txt"</span></span>
<span><span class="co">#&gt; [2] "s3://bucket-sdcghqxilarjzpnk/file68b71ef3e93.txt" </span></span>
<span><span class="co">#&gt; [3] "s3://bucket-sdcghqxilarjzpnk/file68b71f525e3.txt"</span></span></code></pre></div>
<p>List files in the bucket</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aws_bucket_list_objects.html">aws_bucket_list_objects</a></span><span class="op">(</span><span class="va">my_bucket</span><span class="op">)</span></span>
<span><span class="va">obs</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 8</span></span>
<span><span class="co">#&gt;   bucket          key   uri    size type  etag  lastmodified        storageclass</span></span>
<span><span class="co">#&gt;   &lt;glue&gt;          &lt;chr&gt; &lt;glu&gt; &lt;fs:&gt; &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;       </span></span>
<span><span class="co">#&gt; 1 bucket-sdcghqx… file… s3:/…    53 file  "\"a… 2025-03-12 22:50:19 STANDARD    </span></span>
<span><span class="co">#&gt; 2 bucket-sdcghqx… file… s3:/…    53 file  "\"a… 2025-03-12 22:50:19 STANDARD    </span></span>
<span><span class="co">#&gt; 3 bucket-sdcghqx… file… s3:/…    53 file  "\"a… 2025-03-12 22:50:19 STANDARD</span></span></code></pre></div>
<p>Fetch file attributes</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/aws_file_attr.html">aws_file_attr</a></span><span class="op">(</span><span class="va">remote_files</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 41</span></span>
<span><span class="co">#&gt;   bucket_name    key   uri    size type  etag  last_modified       delete_marker</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt; &lt;fs:&gt; &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;lgl&gt;        </span></span>
<span><span class="co">#&gt; 1 bucket-sdcghq… file… s3:/…    53 file  "\"a… 2025-03-12 22:50:19 NA           </span></span>
<span><span class="co">#&gt; 2 bucket-sdcghq… file… s3:/…    53 file  "\"a… 2025-03-12 22:50:19 NA           </span></span>
<span><span class="co">#&gt; 3 bucket-sdcghq… file… s3:/…    53 file  "\"a… 2025-03-12 22:50:19 NA           </span></span>
<span><span class="co">#&gt; # ℹ 33 more variables: accept_ranges &lt;chr&gt;, expiration &lt;chr&gt;, restore &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   archive_status &lt;chr&gt;, checksum_crc32 &lt;chr&gt;, checksum_crc32_c &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   checksum_crc64_nvme &lt;chr&gt;, checksum_sha1 &lt;chr&gt;, checksum_sha256 &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   checksum_type &lt;chr&gt;, missing_meta &lt;int&gt;, version_id &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   cache_control &lt;chr&gt;, content_disposition &lt;chr&gt;, content_encoding &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   content_language &lt;chr&gt;, content_type &lt;chr&gt;, content_range &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   expires &lt;dttm&gt;, website_redirect_location &lt;chr&gt;, …</span></span></code></pre></div>
<p>Check if one or more files exist</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/aws_file_exists.html">aws_file_exists</a></span><span class="op">(</span><span class="va">remote_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/aws_file_exists.html">aws_file_exists</a></span><span class="op">(</span><span class="va">remote_files</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span></code></pre></div>
<p>Copy files</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_bucket</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/random_string.html">random_bucket</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/aws_bucket_create.html">aws_bucket_create</a></span><span class="op">(</span><span class="va">new_bucket</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "http://bucket-ujdvcgpqwhxstlyz.s3.amazonaws.com/"</span></span>
<span></span>
<span><span class="co"># add existing files to the new bucket</span></span>
<span><span class="fu"><a href="../reference/aws_file_copy.html">aws_file_copy</a></span><span class="op">(</span><span class="va">remote_files</span>, <span class="va">new_bucket</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s3://bucket-ujdvcgpqwhxstlyz/file68b73610b168.txt"</span></span>
<span><span class="co">#&gt; [2] "s3://bucket-ujdvcgpqwhxstlyz/file68b71ef3e93.txt" </span></span>
<span><span class="co">#&gt; [3] "s3://bucket-ujdvcgpqwhxstlyz/file68b71f525e3.txt"</span></span>
<span></span>
<span><span class="co"># create bucket that doesn't exist yet</span></span>
<span><span class="co"># the force=TRUE makes this work non-interactively</span></span>
<span><span class="va">another_bucket</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/random_string.html">random_bucket</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/aws_file_copy.html">aws_file_copy</a></span><span class="op">(</span><span class="va">remote_files</span>, <span class="va">another_bucket</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s3://bucket-cwalziftpomkqyxv/file68b73610b168.txt"</span></span>
<span><span class="co">#&gt; [2] "s3://bucket-cwalziftpomkqyxv/file68b71ef3e93.txt" </span></span>
<span><span class="co">#&gt; [3] "s3://bucket-cwalziftpomkqyxv/file68b71f525e3.txt"</span></span></code></pre></div>
<p>Download files</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/aws_file_download.html">aws_file_download</a></span><span class="op">(</span><span class="va">remote_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">tfile</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "/var/folders/qt/fzq1m_bj2yb_7b2jz57s9q7c0000gp/T//RtmpgkiUGL/file68b7188a278"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">tfile</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "a b c d e f g h i j k l m n o p q r s t u v w x y z "</span></span></code></pre></div>
<p>Rename files</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/aws_file_exists.html">aws_file_exists</a></span><span class="op">(</span><span class="va">remote_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="../reference/aws_file_rename.html">aws_file_rename</a></span><span class="op">(</span><span class="va">remote_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/pkg/s3fs/man/path.html" class="external-link">s3_path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">remote_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="st">"myfile.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s3://bucket-sdcghqxilarjzpnk/myfile.txt"</span></span>
<span><span class="fu"><a href="../reference/aws_file_exists.html">aws_file_exists</a></span><span class="op">(</span><span class="va">remote_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="magical-methods">“Magical” methods<a class="anchor" aria-label="anchor" href="#magical-methods"></a>
</h2>
<p>Magical methods are prefixed with <code>six_</code> and wrap
<code>aws_</code> functions, adding helpful prompts and checks to make
it more likely you’ll get your task done faster.</p>
<div class="section level3">
<h3 id="magical-bucket-methods">Magical bucket methods<a class="anchor" aria-label="anchor" href="#magical-bucket-methods"></a>
</h3>
<p>The magical bucket functions are:</p>
<ul>
<li><code>six_bucket_add_user</code></li>
<li><code>six_bucket_change_user</code></li>
<li><code>six_bucket_delete</code></li>
<li><code>six_bucket_permissions</code></li>
<li><code>six_bucket_remove_user</code></li>
</ul>
<p>An example of using one of the functions,
<code><a href="../reference/six_bucket_add_user.html">six_bucket_add_user()</a></code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a bucket</span></span>
<span><span class="va">bucket</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/random_string.html">random_bucket</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="../reference/aws_bucket_exists.html">aws_bucket_exists</a></span><span class="op">(</span><span class="va">bucket</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/aws_bucket_create.html">aws_bucket_create</a></span><span class="op">(</span><span class="va">bucket</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; [1] "http://bucket-eoxhtgipqjnrskaf.s3.amazonaws.com/"</span></span>
<span></span>
<span><span class="co"># create a user</span></span>
<span><span class="va">user</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/random_string.html">random_user</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="../reference/aws_user_exists.html">aws_user_exists</a></span><span class="op">(</span><span class="va">user</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/aws_user_create.html">aws_user_create</a></span><span class="op">(</span><span class="va">user</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 6</span></span>
<span><span class="co">#&gt;   UserName        UserId     Path  Arn   CreateDate          PasswordLastUsed</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt;              &lt;dttm&gt;          </span></span>
<span><span class="co">#&gt; 1 SimplisticSnail AIDA22PL7… /     arn:… 2025-03-12 22:50:24 NA</span></span>
<span></span>
<span><span class="fu"><a href="../reference/six_bucket_add_user.html">six_bucket_add_user</a></span><span class="op">(</span></span>
<span>  bucket <span class="op">=</span> <span class="va">bucket</span>,</span>
<span>  username <span class="op">=</span> <span class="va">user</span>,</span>
<span>  permissions <span class="op">=</span> <span class="st">"read"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ SimplisticSnail now has read access to bucket bucket-eoxhtgipqjnrskaf</span></span>
<span></span>
<span><span class="co"># cleanup</span></span>
<span><span class="fu"><a href="../reference/six_user_delete.html">six_user_delete</a></span><span class="op">(</span><span class="va">user</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Policy S3ReadOnlyAccessBucketeoxhtgipqjnrskaf detached</span></span>
<span><span class="co">#&gt; ! No access keys found for SimplisticSnail</span></span>
<span><span class="co">#&gt; ℹ SimplisticSnail deleted</span></span>
<span><span class="fu"><a href="../reference/aws_bucket_delete.html">aws_bucket_delete</a></span><span class="op">(</span><span class="va">bucket</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="magical-file-methods">Magical file methods<a class="anchor" aria-label="anchor" href="#magical-file-methods"></a>
</h3>
<p>There’s one file function: <code><a href="../reference/six_file_upload.html">six_file_upload()</a></code>. An example
of using it:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bucket</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/random_string.html">random_bucket</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">demo_rds_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Meta/demo.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/six_file_upload.html">six_file_upload</a></span><span class="op">(</span><span class="va">demo_rds_file</span>, <span class="va">bucket</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s3://bucket-hnwctmpyreodfqlj/demo.rds"</span></span>
<span></span>
<span><span class="co">## many files at once</span></span>
<span><span class="va">links_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Meta/links.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/six_file_upload.html">six_file_upload</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">demo_rds_file</span>, <span class="va">links_file</span><span class="op">)</span>, <span class="va">bucket</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s3://bucket-hnwctmpyreodfqlj/demo.rds" </span></span>
<span><span class="co">#&gt; [2] "s3://bucket-hnwctmpyreodfqlj/links.rds"</span></span>
<span></span>
<span><span class="co"># set expiration, expire 1 minute from now</span></span>
<span><span class="fu"><a href="../reference/six_file_upload.html">six_file_upload</a></span><span class="op">(</span><span class="va">demo_rds_file</span>, <span class="va">bucket</span>, Expires <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fl">60</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "s3://bucket-hnwctmpyreodfqlj/demo.rds"</span></span>
<span></span>
<span><span class="co"># cleanup</span></span>
<span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aws_bucket_list_objects.html">aws_bucket_list_objects</a></span><span class="op">(</span><span class="va">bucket</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/aws_file_delete.html">aws_file_delete</a></span><span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">uri</span><span class="op">)</span></span>
<span><span class="co">#&gt; s3://bucket-hnwctmpyreodfqlj/demo.rds</span></span>
<span><span class="co">#&gt; s3://bucket-hnwctmpyreodfqlj/links.rds</span></span>
<span><span class="fu"><a href="../reference/aws_bucket_delete.html">aws_bucket_delete</a></span><span class="op">(</span><span class="va">bucket</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sean Kross, Scott Chamberlain, Fred Hutchinson Cancer Center.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
